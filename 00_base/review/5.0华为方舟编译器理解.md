### 华为方舟编译器理解

https://github.com/Himself65/OpenArkCompiler

方舟编译器主要要做的事情：

- 将多语言之间联合优化，比如c/c++、 java包括前端（JS)等，然后自己设计一个IR，不同的前端分析完后，然后转为统一的IR，这个是编译原理上常做的事；

具体可见对于mapleIR的说明：

https://github.com/Himself65/OpenArkCompiler/blob/master/doc/MapleIRDesign.md

- 由于目前形成了一个以移动端手机为中心的智能中心，但是不能满足目前Android7.0以后以上的AOT+JIT的联合编译解释的模式，说到底感觉无论是启动什么的还是慢。方舟编译器把所有的Android系统上的框架全部编译为native层。减少java与C++ 之间的JNI调用开销。然后这个事交给开发者在编译的时候处理。
- 打造成自己的一个生态环，你要想用这个方舟编译器带来好的用户体验就得用我华为自己的runtime；要不然自己开发代价高。
- 同时对于jdk中内存回收机制，最常见的RC机制，需要进一步的优化。



核心： 流畅度  CPU降低开销  功耗（不发热 续航更好） 

#### 机器码

- 汇编器

将汇编代码直接翻译成机器码。由于汇编代码一般和机器码都是一一对应的，所以它的速度非常快。只是汇编语言，你懂的，可读性差， 用起来难，用来写大型程序对于普通开发者基本是不现实的。

- 编译器

编译器将我们平常开发用的高级语言，例如 Java/C++ 等，翻译成机器码供 CPU 使用。这种编译很慢，但是执行起来会很快。

- 解释器

程序不需要编译，程序在运行时才翻译成机器语言，每执行一次都要翻译一次。因此效率比较低。可以想象这种运行方式就慢了很多。 典型的解释型语言，php/js/python 等。

#### java如何执行

Java 程序的执行依赖于 Java 虚拟机（JVM），JVM 能直接识别的叫做字节码。Java 代码经过编译会生成 Class 文件，即字节码文件，再交由 JVM 处理。而 JVM 又是怎么执行 Class 文件的呢？这里以 HotSpot 为例，Class 文件被虚拟机加载后会存放在方法区，实际运行时，虚拟机会执行方法区中的代码。

将字节码翻译成机器码的工作自然就由 JVM 来承担了。在 HotSpot 中，有几种翻译形式。

- 解释执行

逐条将字节码翻译成机器码并执行

- 即时编译（Just-in-time ，JIT）

将一个方法中包含的所有字节码编译成机器码后再执行。前者的优势在于无需等待编译，而后者的优势在于实际运行速度更快。HotSpot 默认采用混合模式，综合了解释执行和即时编译两 者的优点。它会先解释执行字节码，而后将其中反复执行的热点代码，以方法为单位进行即时编译。

#### HarmonyOS

HarmonyOS是一款“面向未来”、面向全场景（移动办公、运动健康、社交通信、媒体娱乐等）的分布式操作系统。在传统的单设备系统能力的基础上，HarmonyOS提出了基于同一套系统能力、适配多种终端形态的分布式理念，能够支持多种终端设备。

- 对消费者而言，HarmonyOS能够将生活场景中的各类终端进行能力整合，形成一个“超级虚拟终端”，可以实现不同的终端设备之间的快速连接、能力互助、资源共享，匹配合适的设备、提供流畅的全场景体验。
- 对应用开发者而言，HarmonyOS采用了多种分布式技术，使得应用程序的开发实现与不同终端设备的形态差异无关，降低了开发难度和成本。这能够让开发者聚焦上层业务逻辑，更加便捷、高效地开发应用。
- 对设备开发者而言，HarmonyOS采用了组件化的设计方案，可以根据设备的资源能力和业务特征进行灵活裁剪，满足不同形态的终端设备对于操作系统的要求。

https://device.harmonyos.com/cn/docs/start/learn/oem_des_define-0000001084307840

![image-20210525204309950](https://i.loli.net/2021/05/25/iLtXcl8JvOhATeC.png)

优点：

HarmonyOS提供了用户程序框架、Ability框架以及UI框架，支持应用开发过程中多终端的业务逻辑和界面逻辑进行复用，能够实现应用的一次开发、多端部署，提升了跨设备应用的开发效率。一次开发、多端部署。

![image-20210525204403654](https://i.loli.net/2021/05/25/SzkwGZel1tv5YPL.png)

#### 技术架构

![image-20210525204429989](https://i.loli.net/2021/05/25/ne2QyFOJCcEHbDU.png)

 #### 杂谈

https://developer.harmonyos.com/cn/docs/documentation/doc-guides/ability-ability-overview-0000000000029852