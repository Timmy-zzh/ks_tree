#### 1.TCP概述

- TCP是面向连接的通信协议，通过三次握手建立连接，然后才能开始数据的读写，通讯完成时要断开连接，由于TCP是面向连接的所以只能用于端到端的通讯
- TCP提供的是一种可靠的数据流服务，数据有可能被拆分后发送，那么采用超时重传机制和应答确认机制是组成TCP可靠传输的关键涉及
  - 超时重传机制中最重要的就是重传超时的时间选择
    - RTT（round-trip-time往返时延）：根据网络情况动态调整
    - 需要采样统计一个数据包从发送端发送出去，到接收到这个包的回复这段时长来动态设置重传超时值。
- IP层进行数据传输时，时不能保证数据包按照发送顺序到达目的机器的。当接收端IP网络层将数据向上传送到TCP层后，TCP将包排序并进行错误检查。
  - TCP数据包中包括序号和确认，所以未按照顺寻收到的包可以被排序，而顺坏的包可以被重传
- TCP采用一种称为“滑动窗口”的方式进行流量控制，**所谓窗口实际表示接收能力，用以限制发送方的发送速度。**
- 同时TCP还允许在一个TCP连接上，通信的双方可以同时传输数据，也就是所谓的全双工。
- 面向连接的服务（Telnet，FTP，rlogin，SMTP等）需要高度的可靠性，所以使用了TCP。

#### 2.TCP三次握手

<img src=".\res2\1.TCP三次握手.png" alt="1.TCP三次握手" style="zoom:70%;" />

- TCP提供面向有连接的通信传输。面向有连接的是指在数据通信开始之前先做好两端之间的准备工作

**所谓三次握手：**是指建立一个TCP连接时需要客户端和服务端总共发送三个包以确认连接的建立，在socket编程中，这以过程由客户端执行connect来触发。

**第一次握手：**客户端将标志位SYN置为1，随机产生一个值seq=J，并将该数据包发送给服务器端，客户端进行SYN_SENT状态，等待服务器端确认。

**第二次握手：**服务器端收到数据包后，由标志位SYN=1知道客户端请求连接，服务器端将标志位SYN和ACK都置为1，ack=J+1，随机产生一个值seq=K，并将该数据包发送给客户端以确认连接请求，服务器端进入SYN_RCVD状态

**第三次握手：**客户端收到确认后，检查ack是否为J+1，ACK是否为1，如果正确则将标志ACK置为1，ack=K+1，并将该数据包发送给服务器端，服务器端检查ack是否为K+1，ACK是否为1，如果正确则连接建立成功，客户端和服务器端进入ESTABLISHED状态，完成三次握手，随后客户端与服务器端之间可以开始传输数据了。

#### 3.为什么需要三次握手













